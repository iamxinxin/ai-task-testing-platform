<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI任务自动化测试平台</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="/static/css/style.css" rel="stylesheet">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="/">
                <i class="fas fa-robot me-2"></i>
                AI任务自动化测试平台
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="#dashboard">仪表板</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#test-cases">测试用例</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#models">模型管理</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#results">测试结果</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-fluid mt-4">
        <div class="row">
            <!-- 侧边栏 -->
            <div class="col-md-3 col-lg-2">
                <div class="sidebar">
                    <ul class="nav nav-pills flex-column">
                        <li class="nav-item">
                            <a class="nav-link active" href="#" onclick="showSection('dashboard')">
                                <i class="fas fa-tachometer-alt me-2"></i>仪表板
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" onclick="showSection('classification')">
                                <i class="fas fa-tags me-2"></i>分类任务
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" onclick="showSection('correction')">
                                <i class="fas fa-spell-check me-2"></i>纠错任务
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" onclick="showSection('dialogue')">
                                <i class="fas fa-comments me-2"></i>对话任务
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" onclick="showSection('rag')">
                                <i class="fas fa-search me-2"></i>RAG任务
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" onclick="showSection('agent')">
                                <i class="fas fa-cogs me-2"></i>Agent任务
                            </a>
                        </li>
                    </ul>
                </div>
            </div>

            <!-- 主内容区 -->
            <div class="col-md-9 col-lg-10">
                <!-- 仪表板 -->
                <div id="dashboard-section" class="content-section">
                    <h2><i class="fas fa-tachometer-alt me-2"></i>仪表板</h2>
                    
                    <!-- 概览卡片 -->
                    <div class="row mb-4">
                        <div class="col-md-3">
                            <div class="card bg-primary text-white">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <h4 id="total-tests">0</h4>
                                            <p class="mb-0">总测试数</p>
                                        </div>
                                        <i class="fas fa-vial fa-2x"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card bg-success text-white">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <h4 id="avg-score">0.0</h4>
                                            <p class="mb-0">平均分数</p>
                                        </div>
                                        <i class="fas fa-star fa-2x"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card bg-info text-white">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <h4 id="avg-time">0.0s</h4>
                                            <p class="mb-0">平均执行时间</p>
                                        </div>
                                        <i class="fas fa-clock fa-2x"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card bg-warning text-white">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between">
                                        <div>
                                            <h4 id="recent-tests">0</h4>
                                            <p class="mb-0">近7天测试</p>
                                        </div>
                                        <i class="fas fa-calendar-week fa-2x"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 图表区域 -->
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h5>任务类型分布</h5>
                                </div>
                                <div class="card-body">
                                    <canvas id="taskTypeChart"></canvas>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h5>模型性能对比</h5>
                                </div>
                                <div class="card-body">
                                    <canvas id="modelPerformanceChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 最近测试结果 -->
                    <div class="row mt-4">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header">
                                    <h5>最近测试结果</h5>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-striped" id="recent-tests-table">
                                            <thead>
                                                <tr>
                                                    <th>测试用例</th>
                                                    <th>任务类型</th>
                                                    <th>模型</th>
                                                    <th>分数</th>
                                                    <th>状态</th>
                                                    <th>执行时间</th>
                                                    <th>创建时间</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <!-- 动态加载 -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 分类任务 -->
                <div id="classification-section" class="content-section" style="display: none;">
                    <h2><i class="fas fa-tags me-2"></i>分类任务测试</h2>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h5>创建测试用例</h5>
                                </div>
                                <div class="card-body">
                                    <form id="classification-form">
                                        <div class="mb-3">
                                            <label class="form-label">测试用例名称</label>
                                            <input type="text" class="form-control" name="name" required>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">描述</label>
                                            <textarea class="form-control" name="description" rows="2"></textarea>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">输入文本</label>
                                            <textarea class="form-control" name="text" rows="3" required></textarea>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">可选标签（用逗号分隔）</label>
                                            <input type="text" class="form-control" name="labels" placeholder="positive,negative,neutral">
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">期望标签</label>
                                            <input type="text" class="form-control" name="expected_label" required>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">期望置信度</label>
                                            <input type="number" class="form-control" name="expected_confidence" min="0" max="1" step="0.01" value="0.8">
                                        </div>
                                        <button type="submit" class="btn btn-primary">创建测试用例</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h5>运行测试</h5>
                                </div>
                                <div class="card-body">
                                    <form id="run-classification-test">
                                        <div class="mb-3">
                                            <label class="form-label">选择测试用例</label>
                                            <select class="form-select" name="test_case_id" required>
                                                <option value="">请选择测试用例</option>
                                            </select>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">选择模型</label>
                                            <select class="form-select" name="model_name" required>
                                                <option value="mock-classifier">Mock分类器</option>
                                                <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
                                                <option value="gpt-4">GPT-4</option>
                                                <option value="claude-3-sonnet">Claude-3 Sonnet</option>
                                            </select>
                                        </div>
                                        <button type="submit" class="btn btn-success">运行测试</button>
                                    </form>
                                    
                                    <div id="classification-result" class="mt-3" style="display: none;">
                                        <h6>测试结果：</h6>
                                        <div class="alert alert-info">
                                            <pre id="classification-result-content"></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 其他任务类型的界面类似，这里省略以节省空间 -->
                <div id="correction-section" class="content-section" style="display: none;">
                    <h2><i class="fas fa-spell-check me-2"></i>纠错任务测试</h2>
                    <p>纠错任务测试界面开发中...</p>
                </div>

                <div id="dialogue-section" class="content-section" style="display: none;">
                    <h2><i class="fas fa-comments me-2"></i>对话任务测试</h2>
                    <p>对话任务测试界面开发中...</p>
                </div>

                <div id="rag-section" class="content-section" style="display: none;">
                    <h2><i class="fas fa-search me-2"></i>RAG任务测试</h2>
                    <p>RAG任务测试界面开发中...</p>
                </div>

                <div id="agent-section" class="content-section" style="display: none;">
                    <h2><i class="fas fa-cogs me-2"></i>Agent任务测试</h2>
                    <p>Agent任务测试界面开发中...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- 加载提示 -->
    <div id="loading-overlay" class="loading-overlay" style="display: none;">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="/static/js/app.js"></script>
</body>
</html>